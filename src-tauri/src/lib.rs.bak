mod commands;
mod db;
mod models;


pub fn run() {
  tauri::Builder::default()
    .plugin(tauri_plugin_dialog::init())
    .setup(|app| {
      let app_handle = app.handle();
      db::init_db(&app_handle)?;
      Ok(())
    })
    .invoke_handler(tauri::generate_handler![
      commands::db_health,
      commands::list_projects,
      commands::create_project,
      commands::touch_project,
      commands::get_project,
      commands::list_tasks,
      commands::create_task,
      commands::get_task,
      commands::list_runs,
      commands::create_run,
      commands::list_messages,
      commands::add_message,
      commands::list_artifacts,
      commands::upsert_artifact,
      commands::get_settings,
      commands::get_setting,
      commands::set_setting,
      commands::set_settings,
    ])
    .run(tauri::generate_context!())
    .expect("error while running tauri application");
}
